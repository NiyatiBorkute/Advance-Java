package com.demo.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.List;

import com.demo.beans.Dept;


public class DeptDaoImpl implements DeptDao {

	static Connection conn;
	static PreparedStatement insdept,deleteByDeptno,updateByDeptno;
    static {
    	
    	try {
    		conn=DBUtil.getMyConnection();
			insdept=conn.prepareStatement("insert into dept values(?,?,?,?,?)");
			deleteByDeptno=conn.prepareStatement("delete from dept where deptno=?");
			updateByDeptno=conn.prepareStatement("update dept set loc=?,pwd=? where deptno=?");
		} catch (SQLException e) {
			e.printStackTrace();
		}
    }

@Override
public boolean save(Dept d) {
		try {
			insdept.setInt(1, d.getDeptno());
			insdept.setString(2, d.getDname());
			insdept.setString(3, d.getLoc());
			insdept.setString(4, d.getPwd());
			insdept.setDate(5, java.sql.Date.valueOf(d.getStartedon()));
			int n=insdept.executeUpdate();
			return n>0;
		} catch (SQLException e) {

			e.printStackTrace();
		}
		return false;
		
	}

@Override
public boolean removeByDeptno(int deptno) {
	try {
		deleteByDeptno.setInt(1, deptno);
		int n=deleteByDeptno.executeUpdate();
		if(n>0)
			return true;
	} catch (SQLException e) {
		// TODO Auto-generated catch block
		e.printStackTrace();
	}
	return false;
}

@Override
public boolean updateByDeptno(int deptno, String loc, String pwd) {
	try {
		updateByDeptno.setString(1, loc);
		updateByDeptno.setString(2, pwd);
		updateByDeptno.setInt(3, deptno);
		int n=updateByDeptno.executeUpdate();
		if(n>0)
			return true;
	} catch (SQLException e) {

		e.printStackTrace();
	}
	return false;
}

@Override
public Dept findById(int deptno) {
	// TODO Auto-generated method stub
	return null;
}

@Override
public List<Dept> findAllDept() {
	// TODO Auto-generated method stub
	return null;
}

@Override
public List<Dept> arrangeByPwd() {
	// TODO Auto-generated method stub
	return null;
}

}

	
	
